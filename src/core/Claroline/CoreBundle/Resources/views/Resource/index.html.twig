{% extends "ClarolineCoreBundle:Administration:administration.html.twig" %}
{% block stylesheets %}
    {{ parent() }}
    <link rel='stylesheet' type='text/css' href='{{ asset('bundles/clarolinecore/js/jquery/plugin/dynatree/src/skin/ui.dynatree.css') }}'>
    <link rel='stylesheet' type='text/css' href='{{ asset('bundles/clarolinecore/js/jquery/plugin/contextMenu-medialize/src/jquery.contextMenu.css') }}'>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src='{{ asset('bundles/clarolinecore/js/jquery/plugin/dynatree/src/jquery.dynatree.js') }}' type="text/javascript"></script>
    <script src='{{ asset('bundles/clarolinecore/js/jquery/plugin/contextMenu-medialize/src/jquery.contextMenu.js')}}'></script>
    <script src='{{ asset('bundles/clarolinecore/js/resource/index.js') }}' type="text/javascript"></script>
{% endblock %}
{% block section_content %}

<div id="translation-claroline" 
        {% for resourceType in resourcesType %}    
        data-{{resourceType.getType()}}={{ resourceType.getType() |trans({}, 'platformTranslation') }}
        {% endfor %}
></div>
    
<div id="data-claroline"
     data-workspace_id = {{app.user.getPersonnalWorkspace().getId()}}
></div>

{% if directory is defined and is_granted('OWNER', directory)  %}
<form action="{{ path('claro_resource_show_form', {'id':id}) }}" method="post" id="form_resource">
    <select id="select_resource_form_type" required="required" name="select_resource_form[type]">
        {% for resourceType in resourcesType %}
            <option value={{ resourceType.getId()}}>{{ resourceType.getType() |trans({}, 'platformTranslation') }}</option>          
        {% endfor %}
    </select> 
    <input type="submit" />
</form>
{% else %}
    {% if directory is not defined %}
        <form action="{{ path('claro_resource_show_form', {'id':id}) }}" method="post" id="form_resource">
        <select id="select_resource_form_type" required="required" name="select_resource_form[type]">
            {% for resourceType in resourcesType %}
                <option value={{ resourceType.getId()}}>{{ resourceType.getType() |trans({}, 'platformTranslation') }}</option>          
            {% endfor %}
        </select> 
        <input type="submit" />
        </form>    
    {% endif %}
{% endif %}
    <br><br>
    NAVIGABLE
    {% for resource in resources %}
        {% if resource.getResourceType.getNavigable() == true %}
            <div class="row_resource" data-resource_id={{resource.getId()}}>
                <a href="{{path('claro_resource_default_click', {'id':resource.getId()})}}" 
                   id="link_resource_{{resource.getId()}}" 
                   class="link_resource_view">{{resource.getResource().getName()}}
                </a> | 
                {{resource.getResourceType().getType()}} 
                {% if is_granted('OWNER', resource) %}
                | 
                <a id="link_resource_delete_{{resource.getId()}}" 
                   href="{{path('claro_resource_remove_workspace',  {'resourceId':resource.getId(), 'workspaceId':app.user.getPersonnalWorkspace.getId()})}}" 
                   class="link_delete_resource">
                   {{ 'delete'|trans({}, 'platformTranslation') }}
                </a>
                {% endif %}
                | 
                <a id="link_resource_open_{{resource.getId()}}" 
                   href="{{path('claro_resource_open', {'workspaceId':workspace.getId(), 'id':resource.getId()})}}" 
                   class="link_open_resource">
                    {{ 'open'|trans({}, 'platformTranslation') }}
                </a> 
                |
                {{ 'owner'|trans({}, 'platformTranslation') }}: {{resource.getUser().getUsername()}}
                | 
                {% if resource.getCopy() == true %}
                COPY
                {% else %}
                ORIGNAL
                {% endif %}
            </div>
        {% endif %}
    {% endfor %}            
    NOT NAVIGABLE
    {%for resource in resources %}
        {% if resource.getResourceType.getNavigable() == false %}
            <div class="row_resource" data-resource_id={{resource.getId()}}>
                <a href="{{path('claro_resource_default_click', {'id':resource.getId()})}}" 
                   id="link_resource_view_{{resource.getId()}}" 
                   class="link_resource_view">
                    {{resource.getResource().getName()}}
                </a> | 
                {{resource.getResourceType().getType()}} 
                {% if is_granted('OWNER', resource) %}
                | 
                <a id="link_resource_delete_{{resource.getId()}}" 
                   href="{{path('claro_resource_remove_workspace',  {'resourceId':resource.getId(), 'workspaceId':app.user.getPersonnalWorkspace.getId()})}}" 
                   class="link_delete_resource">
                   {{ 'delete'|trans({}, 'platformTranslation') }}
                </a> 
                {% endif %}
                | 
                <a id="link_resource_open_{{resource.getId()}}" 
                   href="{{path('claro_resource_open', {'workspaceId':workspace.getId(), 'id':resource.getId()})}}" 
                   class="link_open_resource">
                   {{ 'open'|trans({}, 'platformTranslation') }}
                </a>
                |
                <a id="link_resource_edit_{{resource.getId()}}"
                   href="{{path('claro_resource_edit', {'workspaceId':workspace.getId(), 'resourceId':resource.getId(), 'options':'ref'})}}"
                   class="link_edit_resource">
                   edit
                </a>
                |
                {{ 'owner'|trans({}, 'platformTranslation') }}: {{resource.getUser().getUsername()}}
                | 
                {% if resource.getCopy() == true %}
                COPY
                {% else %}
                ORIGNAL
                {% endif %}
            </div>
        {% endif %}
    {% endfor %}          
    <button id="dialog_tree_button">resources</button>
    <div id="ct_dialog"></div>
{% endblock %}